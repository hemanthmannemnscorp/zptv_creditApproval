sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/routing/History","sap/m/Dialog","sap/m/DialogType","sap/ui/core/ValueState","sap/m/Button","sap/m/ButtonType","sap/m/Label","sap/m/MessageBox","sap/m/MessageToast","sap/m/Text","sap/m/HBox"],function(e,r,t,a,o,s,n,i,p,l,u,c){"use strict";return e.extend("com.pcard.zptv_credit_approval.controller.ApprovalDetail",{onInit:function(){var e=sap.ui.core.UIComponent.getRouterFor(this);e.getRoute("ApprovalDetail").attachPatternMatched(this._onObjectMatched,this)},_onObjectMatched:function(e){var r=e.getParameter("arguments").pernr;var t=e.getParameter("arguments").card;if(t==="null"){t=""}var a=this.getView().getModel("pcardListModel");var o=this.getView().getModel("oDetailModel");a.read("/LimitRequestSet(Pernr='"+r+"',CardNo='"+t+"')",{success:function(e){o.setData(e)}})},onNavBack:function(){var e=r.getInstance();var t=e.getPreviousHash();var a=sap.ui.core.UIComponent.getRouterFor(this);a.navTo("ApprovalHome",true);window.history.go(0)},onFilesSubmitReq:function(){var e=false;var r=this.getView().getModel("oDetailModel").getData();this._oData=this.getView().getModel("oDetailModel").getData();if(r.CrStatus==false){var i=r.AprCrnote;if(i==""){e=true;if(!this.oErrorMessageDialog){this.oErrorMessageDialog=new t({type:a.Message,title:"Error",state:o.Error,content:new u({text:"Please add Reason for Denial."}),beginButton:new s({type:n.Emphasized,text:"OK",press:function(){this.oErrorMessageDialog.close()}.bind(this)})})}this.oErrorMessageDialog.open()}}if(r.TrStatus==false){var l=r.AprTrnote;if(l==""){e=true;if(!this.oErrorMessageDialog){this.oErrorMessageDialog=new t({type:a.Message,title:"Error",state:o.Error,content:new u({text:"Please add Reason for Denial."}),beginButton:new s({type:n.Emphasized,text:"OK",press:function(){this.oErrorMessageDialog.close()}.bind(this)})})}this.oErrorMessageDialog.open()}}if(e==false){var c=this._oData;var d=[];if(c.Pernr!==""){var g=new Date;var h={Pernr:c.Pernr,CardNo:c.CardNo,TrType:c.TrType,CrLimit:c.CrLimit,TrLimit:c.TrLimit,TrDate:g,RepMgrId:c.RepMgrId,RepMgr:c.RepMgr,Nachn:c.Nachn,Vorna:c.Vorna,Addr1:c.Addr1,Addr2:c.Addr2,City:c.City,State:c.State,Zcode:c.Zcode,Country:c.Country,Wphone:c.Wphone,Email:c.Email,Appr:c.Appr,CrReason:c.CrReason,TrReason:c.TrReason,Maxcred:c.Maxcred,Maxtrans:c.Maxtrans,CrStatus:c.CrStatus,TrStatus:c.TrStatus,AprCrnote:c.AprCrnote,AprTrnote:c.AprTrnote};d.push(h);var m={Pernr:"00106072",CardNo:"7267289287628298",TrType:"DAC",CrLimit:"00250001",TrLimit:"00002000",TrDate:"/Date(1624579200000)/",RepMgrId:"lxe01",RepMgr:"",Nachn:"Jordan",Vorna:"Randy",Addr1:"829 86TH PL S",Addr2:"",City:"BIRMINGHAM",State:"AL",Zcode:"352063549",Country:"US",Wphone:"2053056842",Email:"",Appr:"X",CrReason:"sadfadsf",TrReason:"",Maxcred:"00005000",Maxtrans:"00008000",CrStatus:false,TrStatus:false,AprCrnote:"",AprTrnote:"",ReqToPostNav:d};var v=this.getView().getModel("pcardListModel");var M=this;var f=new sap.m.BusyDialog;f.open();v.create("/LimitRequestSet",m,{success:function(e,r){f.close();p.success("Successfully Submitted",{onClose:function(e){var r=sap.ui.core.UIComponent.getRouterFor(M);r.navTo("ApprovalHome",true);window.history.go(0)}})},error:function(e,r){f.close();p.error("Please try again later!!",{onClose:function(e){var r=sap.ui.core.UIComponent.getRouterFor(M);r.navTo("ApprovalHome",true);window.history.go(0)}})}})}else{alert("No changes made")}}},onFilesCancelReq:function(){var e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("ApprovalHome",true);window.history.go(0)}})});